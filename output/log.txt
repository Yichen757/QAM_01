Step 1: Loaded and cleaned CRSP stock data
         Year  Month  PERMNO  EXCHCD   lag_Mkt_Cap       Ret  Ranking_Ret
0        1927      1   10006       1  6.090000e+01 -0.013547     0.016719
1        1927      1   10022       1  1.142400e+01 -0.075893     0.111727
2        1927      1   10030       1  2.145000e+01  0.009545     0.009212
3        1927      1   10057       1  3.062500e+00 -0.051020    -0.896089
4        1927      1   10073       1  1.276500e+00  0.094595    -0.559615
...       ...    ...     ...     ...           ...       ...          ...
3420610  2024     12   93374       1  7.225731e+03 -0.102210     0.108328
3420611  2024     12   93397       3  5.013174e+02 -0.117446     0.536633
3420612  2024     12   93426       1  2.806015e+02  0.021768    -0.272815
3420613  2024     12   93434       3  1.610220e+01  0.133333    -1.691458
3420614  2024     12   93436       3  1.107984e+06  0.170008     0.039889

[3420615 rows x 7 columns]




Step 2: Constructed Momentum factor and assigned decile ranks
         Year  Month  PERMNO   lag_Mkt_Cap       Ret  DM_decile  KRF_decile  \
0        1927      1   10006  6.090000e+01 -0.013547          6           6   
1        1927      1   10022  1.142400e+01 -0.075893          8           8   
2        1927      1   10030  2.145000e+01  0.009545          6           6   
3        1927      1   10057  3.062500e+00 -0.051020          1           1   
4        1927      1   10073  1.276500e+00  0.094595          2           2   
...       ...    ...     ...           ...       ...        ...         ...   
3420610  2024     12   93374  7.225731e+03 -0.102210          6           5   
3420611  2024     12   93397  5.013174e+02 -0.117446          9          10   
3420612  2024     12   93426  2.806015e+02  0.021768          3           2   
3420613  2024     12   93434  1.610220e+01  0.133333          1           1   
3420614  2024     12   93436  1.107984e+06  0.170008          5           4   

         EXCHCD  
0             1  
1             1  
2             1  
3             1  
4             1  
...         ...  
3420610       1  
3420611       3  
3420612       1  
3420613       3  
3420614       3  

[3420615 rows x 8 columns]




Input: Fama-French Market DataFrame (FF_mkt)
      Year  Month  Market_minus_Rf     SMB     HML      Rf
0     1926      7           0.0296 -0.0256 -0.0243  0.0022
1     1926      8           0.0264 -0.0117  0.0382  0.0025
2     1926      9           0.0036 -0.0140  0.0013  0.0023
3     1926     10          -0.0324 -0.0009  0.0070  0.0032
4     1926     11           0.0253 -0.0010 -0.0051  0.0031
...    ...    ...              ...     ...     ...     ...
1177  2024      8           0.0161 -0.0355 -0.0113  0.0048
1178  2024      9           0.0174 -0.0017 -0.0259  0.0040
1179  2024     10          -0.0097 -0.0101  0.0089  0.0039
1180  2024     11           0.0651  0.0463 -0.0005  0.0040
1181  2024     12          -0.0317 -0.0273 -0.0295  0.0037

[1182 rows x 6 columns]

Step 3: Computed value-weighted monthly portfolio returns
       Year  Month  decile    DM_Ret   KRF_Ret      Rf
0      1927      1       1 -0.033505 -0.033505  0.0025
1      1927      1       2 -0.039143 -0.039143  0.0025
2      1927      1       3  0.026402  0.026402  0.0025
3      1927      1       4 -0.003076 -0.003076  0.0025
4      1927      1       5 -0.003765 -0.003765  0.0025
...     ...    ...     ...       ...       ...     ...
11755  2024     12       6 -0.016957 -0.013169  0.0037
11756  2024     12       7 -0.007466  0.001794  0.0037
11757  2024     12       8 -0.062508 -0.058209  0.0037
11758  2024     12       9 -0.047805 -0.055919  0.0037
11759  2024     12      10  0.006183  0.002042  0.0037

[11760 rows x 6 columns]




Input: Momentum portfolio returns from Daniel's website (DM_returns)
       Year  Month  decile   DM_Ret
0      1927      1       1 -0.03362
1      1927      1       2 -0.04584
2      1927      1       3  0.02755
3      1927      1       4 -0.00319
4      1927      1       5 -0.00294
...     ...    ...     ...      ...
10795  2016     12       6  0.02198
10796  2016     12       7  0.02699
10797  2016     12       8  0.02151
10798  2016     12       9  0.00435
10799  2016     12      10  0.00047

[10800 rows x 4 columns]

Step 4: Validated DM portfolio performance against benchmark data
                        1        2        3        4        5        6  \
Excess Return     -1.9700   3.0000   3.7700   7.2000   7.8700   7.6000   
Volatility        36.9800  30.0100  25.7300  22.8000  21.0300  19.8800   
Sharpe Ratio      -0.0500   0.1000   0.1500   0.3200   0.3700   0.3800   
Skewness           0.0800  -0.1600  -0.2100   0.0900  -0.1500  -0.2500   
corr w/ original   0.9971   0.9974   0.9987   0.9987   0.9988   0.9991   

                        7        8        9       10      WML  
Excess Return      9.5100  10.4500  11.2100  15.6800  17.6500  
Volatility        19.0700  18.6300  19.8100  23.5000  30.4200  
Sharpe Ratio       0.5000   0.5600   0.5700   0.6700   0.5800  
Skewness          -0.6700  -0.5500  -0.7600  -0.7800  -4.6400  
corr w/ original   0.9992   0.9994   0.9991   0.9987   0.9949  




